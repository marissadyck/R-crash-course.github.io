<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="GLMs" />


<title>Assignment 4</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Crash Course 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro to R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_R101.html">Module 1: R 101</a>
    </li>
    <li>
      <a href="mod_2_baseR.html">Module 2: Base R</a>
    </li>
    <li>
      <a href="mod_3_data.html">Module 3: Working with data</a>
    </li>
    <li>
      <a href="mod_4_data_manipulation.html">Module 4: Data manipulation</a>
    </li>
    <li>
      <a href="mod_5_purrr.html">Module 5: The wonders of Purrr</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_plots_baseR.html">Module 1: Data Visualization in Base R</a>
    </li>
    <li>
      <a href="mod_2_ggplot.html">Module 2: Basics of ggplot</a>
    </li>
    <li>
      <a href="mod_3_adv_ggplot.html">Module 3: Advanced ggplot (coming soon)</a>
    </li>
    <li>
      <a href="mod_4_beyond_ggplot.html">Module 4: Beyond ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Modeling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_lm.html">Module 1: Linear regression (coming soon)</a>
    </li>
    <li>
      <a href="mod_2_glm.html">Module 2: Generalized linear models (GLMs)</a>
    </li>
    <li>
      <a href="mod_3_glmm.html">Module 3: General mixed effects models (GLMMs) (coming soon)</a>
    </li>
    <li>
      <a href="mod_4_occ.html">Module 4: Occupancy models (coming soon)</a>
    </li>
    <li>
      <a href="mod_5_sem.html">Module 5: Structural equation models (SEMs) (under construction)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Git
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Getting started with GitHub (under construction)</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="assign_1.html">Assignment 1</a>
    </li>
    <li>
      <a href="assign_2.html">Assignment 2</a>
    </li>
    <li>
      <a href="assign_3.html">Assignment 3</a>
    </li>
    <li>
      <a href="assign_4.html">Assignment 4</a>
    </li>
    <li>
      <a href="assign_5.html">Assignment 5</a>
    </li>
    <li>
      <a href="assign_6.html">Assignment 6</a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="links.html">Links</a>
</li>
<li>
  <a href="terms.html">Terms</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Assignment 4</h1>
<h4 class="author">GLMs</h4>
<h4 class="date">Due Tuesday February 25th <span
class="citation">@11:59pm</span></h4>

</div>


<div id="submission" class="section level1">
<h1>Submission</h1>
<p>Submit you R script as a .R (or .Rmd if using markdown) file to
Brightspace.</p>
<blockquote>
<p>Please make sure your submission includes your name and the
assignment number in the filename</p>
</blockquote>
</div>
<div id="grading" class="section level1">
<h1>Grading</h1>
<blockquote>
<p>You should always be following best coding practices (see Intro to R
module 1) but especially for assingment submissions.</p>
</blockquote>
<p>To receive full credit for each assignment</p>
<ul>
<li>Please make sure each problem has its own header so that I can
easily navigate to your answers</li>
<li>Ensure you have comments that explain what you are doing<br />
</li>
<li>Long code chunks should be broken up with spaces and comments to
explain what is happening at each step<br />
</li>
<li>Object names should be lowercase and short but descriptive enough
that they aren’t confused with other objects <em>(For example data1 and
data2 are not good names for dataframes you are working with)</em><br />
</li>
<li>Just because your code runs doesn’t mean it did what you think it
did, always check your data/objects to ensure any functions were
performed correctly (there are several ways to do this)</li>
</ul>
</div>
<div id="before-you-begin" class="section level1">
<h1>Before you begin</h1>
<div id="download-data" class="section level2">
<h2>Download data</h2>
<p>Make sure you have the <a
href="data/raw/pagube_2008_2016_spatial.csv">Bear glm example raw data
(pagube_2008_2016_spatial.csv)</a> downloaded to the data/raw
folder.</p>
</div>
<div id="readme" class="section level2">
<h2>Readme</h2>
<p>Open the <a href="data/README.html">README</a> file for this data-set
which is associated with <a
href="https://conbio.onlinelibrary.wiley.com/doi/full/10.1111/csp2.12884">Pop
et al., 2023</a> and included in the full (GitHub repository)[<a
href="https://github.com/marissadyck/Brown_bear_predation_RO"
class="uri">https://github.com/marissadyck/Brown_bear_predation_RO</a>]
and read about the variables in the pagube_2008_2016_spatial.csv.</p>
<p>Make sure you understand what all the variables are and specifically
which could be independent (explanatory) and dependent (response)
variables. <em>HINT: there is more than one possible response
variable</em></p>
</div>
</div>
<div id="data-import" class="section level1">
<h1>1 Data import</h1>
<ul>
<li>First read in the data as a tibble and save it to the environment
with a descriptive and tidy name of your choice<br />
</li>
<li>In the same code chunk as you read the data in, set the column names
to lowercase<br />
</li>
<li>Also in that code chunk, specify how the variables should be read in
(e.g. factor, numeric, etc.)<br />
</li>
<li>Explore the data and make sure things read in properly, make any
changes if necessary</li>
</ul>
<pre class="r fold-hide"><code>bear_damage &lt;- read_csv(&#39;data/raw/pagube_2008_2016_spatial.csv&#39;,
                        
                        col_types = cols(Damage = col_factor(),
                                         Year = col_factor(),
                                         Month = col_factor(),
                                         Targetspp = col_factor(),
                                         Landcover_code = col_factor(),
                                         .default = col_number())) %&gt;% 
  
  rename_with(tolower)

str(bear_damage)</code></pre>
<pre><code>## spc_tbl_ [3,024 × 24] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ damage          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 2 ...
##  $ year            : Factor w/ 9 levels &quot;2016&quot;,&quot;2009&quot;,..: 1 2 2 3 4 2 3 4 2 5 ...
##  $ month           : Factor w/ 12 levels &quot;0&quot;,&quot;7&quot;,&quot;9&quot;,&quot;8&quot;,..: 1 1 1 1 1 1 2 1 1 3 ...
##  $ targetspp       : Factor w/ 3 levels &quot;alte&quot;,&quot;ovine&quot;,..: NA NA NA NA NA NA 1 NA NA 2 ...
##  $ point_x         : num [1:3024] 489008 491321 491398 491758 492628 ...
##  $ point_y         : num [1:3024] 532778 542207 538028 536946 533069 ...
##  $ bear_abund      : num [1:3024] 0 0 26 26 0 26 26 26 26 26 ...
##  $ landcover_code  : Factor w/ 15 levels &quot;311&quot;,&quot;112&quot;,&quot;231&quot;,..: 1 1 1 1 1 1 2 3 4 5 ...
##  $ altitude        : num [1:3024] 549 596 506 485 530 551 437 527 467 561 ...
##  $ human_population: num [1:3024] 0 0 54 32 0 0 229 0 0 0 ...
##  $ dist_to_forest  : num [1:3024] 0 0 0 0 0 ...
##  $ dist_to_town    : num [1:3024] 1558 2281.6 387.8 60.6 2076.3 ...
##  $ livestock_killed: num [1:3024] 0 0 0 0 0 1 1 0 1 1 ...
##  $ shannondivindex : num [1:3024] 1.083 0.692 0.908 1.555 0.81 ...
##  $ prop_arable     : num [1:3024] 0 0 0 14.1 4.7 ...
##  $ prop_orchards   : num [1:3024] 0 0 0 0 0 0 0 0 0 0 ...
##  $ prop_pasture    : num [1:3024] 25.2 20.2 42.7 25.4 70.1 ...
##  $ prop_ag_mosaic  : num [1:3024] 0 0 0 0 0 ...
##  $ prop_seminatural: num [1:3024] 9.427 1.668 0.166 22.149 2.001 ...
##  $ prop_deciduous  : num [1:3024] 59.4 75.7 50.6 27.4 23.2 ...
##  $ prop_coniferous : num [1:3024] 0 0 0 0 0 0 0 0 0 0 ...
##  $ prop_mixedforest: num [1:3024] 0 0 0 0 0 0 0 0 0 0 ...
##  $ prop_grassland  : num [1:3024] 0 2.4 0.26 0 0 ...
##  $ prop_for_regen  : num [1:3024] 4.17 0 0 0 0 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   .default = col_number(),
##   ..   Damage = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),
##   ..   Year = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),
##   ..   Month = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),
##   ..   Targetspp = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),
##   ..   POINT_X = col_number(),
##   ..   POINT_Y = col_number(),
##   ..   Bear_abund = col_number(),
##   ..   Landcover_code = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),
##   ..   Altitude = col_number(),
##   ..   Human_population = col_number(),
##   ..   Dist_to_forest = col_number(),
##   ..   Dist_to_town = col_number(),
##   ..   Livestock_killed = col_number(),
##   ..   ShannonDivIndex = col_number(),
##   ..   prop_arable = col_number(),
##   ..   prop_orchards = col_number(),
##   ..   prop_pasture = col_number(),
##   ..   prop_ag_mosaic = col_number(),
##   ..   prop_seminatural = col_number(),
##   ..   prop_deciduous = col_number(),
##   ..   prop_coniferous = col_number(),
##   ..   prop_mixedforest = col_number(),
##   ..   prop_grassland = col_number(),
##   ..   prop_for_regen = col_number()
##   .. )
##  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
</div>
<div id="data-cleaning" class="section level1">
<h1>2 Data cleaning</h1>
<p>This data has already been cleaned and checked for errors, but to
give you some practice with data checking and cleaning I will have you
complete the following steps:</p>
<ul>
<li>Check that there isn’t any data for years outside the study
specifications, if there are remove those observations<br />
</li>
<li>Check that all entries appear coded correctly for month, if any are
not remove those observations (0s are okay as these are associated with
pseudo-absences)<br />
</li>
<li>create a new variable (with an informative and tidy name of your
choice) that sums all the proportional habitat type observations
(e.g. prop_arable - prop_for_regen) and check that they all sum to 100,
<em>if they don’t filter out the observations that don’t sum to 100 and
assign this data as a new object to the environment with an informative
and tidy name of your choice</em><br />
</li>
<li>also ensure that this new data set is filtered to only observations
where 10 or fewer livestock were killed in an event</li>
<li>ensure ALL original and new columns are present in this new data
set</li>
<li>when you are done, remove the old data set from the environment, you
will use this new cleaned one for future analyses</li>
</ul>
<pre class="r fold-hide"><code># check that year is correct
summary(bear_damage$year)</code></pre>
<pre><code>## 2016 2009 2014 2012 2013 2011 2010 2015 2008 
##  348  408  396  620  392  160  140  324  236</code></pre>
<pre class="r fold-hide"><code># check that month is correct 
summary(bear_damage$month)</code></pre>
<pre><code>##    0    7    9    8    5   10    6    4    3   11   12    2 
## 2268  139  160  155   84   50  105   27    8   20    7    1</code></pre>
<pre class="r fold-hide"><code># create new data with prop_check column and filter out observations that don&#39;t sum to 100
bear_damage_tidy &lt;- bear_damage %&gt;% 
  
  mutate(prop_check = rowSums(across(contains(&#39;prop&#39;)))) %&gt;% 
  
  # filter to 100 and only livestock events with 10 or fewer animals
  filter(prop_check == 100 &amp;
           livestock_killed &lt;= 10) 


# check data
summary(bear_damage_tidy)</code></pre>
<pre><code>##  damage       year         month      targetspp      point_x      
##  0:922   2012   :245   0      :922   alte  : 16   Min.   :491321  
##  1:198   2013   :160   9      : 42   ovine : 39   1st Qu.:547710  
##          2014   :142   6      : 38   bovine:143   Median :569859  
##          2015   :136   8      : 34   NA&#39;s  :922   Mean   :575292  
##          2009   :132   7      : 31                3rd Qu.:603439  
##          2016   :122   5      : 21                Max.   :658416  
##          (Other):183   (Other): 32                                
##     point_y         bear_abund    landcover_code    altitude     
##  Min.   :447121   Min.   : 0.00   311    :261    Min.   : 255.0  
##  1st Qu.:489899   1st Qu.:19.00   312    :254    1st Qu.: 697.0  
##  Median :519150   Median :31.00   313    :159    Median : 915.0  
##  Mean   :524433   Mean   :30.24   321    :135    Mean   : 917.8  
##  3rd Qu.:552545   3rd Qu.:42.00   231    :129    3rd Qu.:1124.0  
##  Max.   :628579   Max.   :77.00   211    : 80    Max.   :1707.0  
##                                   (Other):102                    
##  human_population  dist_to_forest     dist_to_town   livestock_killed
##  Min.   :  0.000   Min.   :   0.00   Min.   :    0   Min.   :0.0000  
##  1st Qu.:  0.000   1st Qu.:   0.00   1st Qu.: 1790   1st Qu.:0.0000  
##  Median :  0.000   Median :   0.00   Median : 2941   Median :0.0000  
##  Mean   :  2.546   Mean   : 253.24   Mean   : 3561   Mean   :0.5634  
##  3rd Qu.:  0.000   3rd Qu.:  87.58   3rd Qu.: 4770   3rd Qu.:1.0000  
##  Max.   :369.000   Max.   :7073.95   Max.   :13140   Max.   :7.0000  
##                                                                      
##  shannondivindex   prop_arable      prop_orchards  prop_pasture  
##  Min.   :0.0000   Min.   :  0.000   Min.   :0     Min.   : 0.00  
##  1st Qu.:0.5107   1st Qu.:  0.000   1st Qu.:0     1st Qu.: 0.00  
##  Median :0.7850   Median :  0.000   Median :0     Median : 0.00  
##  Mean   :0.7633   Mean   :  7.002   Mean   :0     Mean   : 8.88  
##  3rd Qu.:1.0451   3rd Qu.:  0.000   3rd Qu.:0     3rd Qu.:11.23  
##  Max.   :1.8951   Max.   :100.000   Max.   :0     Max.   :96.11  
##                                                                  
##  prop_ag_mosaic    prop_seminatural prop_deciduous   prop_coniferous  
##  Min.   : 0.0000   Min.   : 0.000   Min.   :  0.00   Min.   :  0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.000   1st Qu.:  0.00   1st Qu.:  0.000  
##  Median : 0.0000   Median : 0.000   Median :  3.13   Median :  6.774  
##  Mean   : 0.8042   Mean   : 1.753   Mean   : 27.40   Mean   : 24.417  
##  3rd Qu.: 0.0000   3rd Qu.: 0.000   3rd Qu.: 56.59   3rd Qu.: 45.989  
##  Max.   :42.9740   Max.   :44.391   Max.   :100.00   Max.   :100.000  
##                                                                       
##  prop_mixedforest prop_grassland   prop_for_regen     prop_check 
##  Min.   :  0.00   Min.   : 0.000   Min.   : 0.000   Min.   :100  
##  1st Qu.:  0.00   1st Qu.: 0.000   1st Qu.: 0.000   1st Qu.:100  
##  Median :  0.00   Median : 0.000   Median : 0.000   Median :100  
##  Mean   : 15.26   Mean   : 8.732   Mean   : 5.758   Mean   :100  
##  3rd Qu.: 22.11   3rd Qu.:13.614   3rd Qu.: 8.162   3rd Qu.:100  
##  Max.   :100.00   Max.   :86.540   Max.   :61.234   Max.   :100  
## </code></pre>
<pre class="r fold-hide"><code># remove old data
rm(bear_damage)</code></pre>
</div>
<div id="summary-statistics" class="section level1">
<h1>3 Summary statistics</h1>
<p>Using your new data set, please calculate some summary statistics to
report</p>
<ul>
<li>Total number of events AND total number of livestock killed by brown
bears across the entire study<br />
</li>
<li>Total number of events of your response variable per livestock type,
year, and month <em>provide comments that highlight which type, year,
and month had the most and least number of events</em><br />
</li>
<li>Number of events of your response variable per livestock type for
each year <em>provide comments that highlight which year had the most
and least number of events for each livestock type</em></li>
</ul>
<pre class="r fold-hide"><code># total number of events &amp; livestock killed 
bear_damage_tidy %&gt;% 
  
  # ensure to only count events of damage
  filter(damage == &#39;1&#39;) %&gt;% 
  
  summarise(n_events = n(),
            total_killed = sum(livestock_killed))</code></pre>
<pre><code>## # A tibble: 1 × 2
##   n_events total_killed
##      &lt;int&gt;        &lt;dbl&gt;
## 1      198          470</code></pre>
<pre class="r fold-hide"><code># damage per species
bear_damage_tidy %&gt;% 
  
  # ensure to only count events of damage
  filter(damage == &#39;1&#39;) %&gt;% 
  
  # group by targetspp to get summaries for each species and year
  group_by(targetspp) %&gt;% 
  
  summarise(n = n())</code></pre>
<pre><code>## # A tibble: 3 × 2
##   targetspp     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 alte         16
## 2 ovine        39
## 3 bovine      143</code></pre>
<pre class="r fold-hide"><code># bovine highest, alte lowest

# damage per year
bear_damage_tidy %&gt;% 
  
  # ensure to only count events of damage
  filter(damage == &#39;1&#39;) %&gt;% 
  
  # group by targetspp to get summaries for each species and year
  group_by(year) %&gt;% 
  
  summarise(n = n()) %&gt;% 
  
  arrange(desc(n))</code></pre>
<pre><code>## # A tibble: 9 × 2
##   year      n
##   &lt;fct&gt; &lt;int&gt;
## 1 2012     42
## 2 2013     34
## 3 2014     28
## 4 2016     26
## 5 2015     25
## 6 2009     12
## 7 2011     11
## 8 2010     11
## 9 2008      9</code></pre>
<pre class="r fold-hide"><code># 2012 had highest number of events and 2008 had lowest number of events

# damage per month
bear_damage_tidy %&gt;% 
  
  # ensure to only count events of damage
  filter(damage == &#39;1&#39;) %&gt;% 
  
  # group by targetspp to get summaries for each species and year
  group_by(month) %&gt;% 
  
  summarise(n = n()) %&gt;% 
  
  arrange(desc(n))</code></pre>
<pre><code>## # A tibble: 10 × 2
##    month     n
##    &lt;fct&gt; &lt;int&gt;
##  1 9        42
##  2 6        38
##  3 8        34
##  4 7        31
##  5 5        21
##  6 10       14
##  7 4        12
##  8 11        4
##  9 3         1
## 10 2         1</code></pre>
<pre class="r fold-hide"><code># september had the highest number of events and Dec/Jan had lowest with 0

# damage per livestock type per year
bear_damage_tidy %&gt;% 
  
  # ensure to only count events of damage
  filter(damage == &#39;1&#39;) %&gt;% 
  
  # group by targetspp to get summaries for each species and year
  group_by(targetspp, year) %&gt;% 
  
  summarise(n = n()) %&gt;% 
  
  arrange(desc(n))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;targetspp&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## # A tibble: 25 × 3
## # Groups:   targetspp [3]
##    targetspp year      n
##    &lt;fct&gt;     &lt;fct&gt; &lt;int&gt;
##  1 bovine    2012     31
##  2 bovine    2013     30
##  3 bovine    2015     22
##  4 bovine    2014     21
##  5 bovine    2016     18
##  6 bovine    2011      8
##  7 ovine     2016      7
##  8 ovine     2012      7
##  9 ovine     2008      7
## 10 bovine    2010      7
## # ℹ 15 more rows</code></pre>
<pre class="r fold-hide"><code># </code></pre>
</div>
<div id="identify-the-response-variable" class="section level1">
<h1>4 Identify the response variable</h1>
<p>Once your data are cleaned and formatted please identify the response
variable for your models <em>(There are two possible response
variables)</em></p>
<p>AND the appropriate distribution for your data <em>You’ll need to
provide some kind of code to show you looked at the response variable to
choose the distribution</em></p>
<pre class="r fold-hide"><code># damage is response variable and the appropriate distribution is binomial

plot(bear_damage_tidy$damage)</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r fold-hide"><code># or livestock killed is response variable which is count data so could be poisson or if highly zero-inflated causes overdispersion then negative binomial
hist(bear_damage_tidy$livestock_killed)</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r fold-hide"><code># lots of zeros lets do a quick test for dispersion with a simple glm
test_glm &lt;- 
glm(livestock_killed ~ bear_abund,
    data = bear_damage_tidy,
    family = &#39;poisson&#39;)

summary(test_glm)</code></pre>
<pre><code>## 
## Call:
## glm(formula = livestock_killed ~ bear_abund, family = &quot;poisson&quot;, 
##     data = bear_damage_tidy)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4672  -1.0886  -0.9689   0.3295   4.8808  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.047516   0.087835 -11.926  &lt; 2e-16 ***
## bear_abund   0.014560   0.002248   6.477 9.34e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 1958.6  on 1119  degrees of freedom
## Residual deviance: 1916.5  on 1118  degrees of freedom
## AIC: 2662.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r fold-hide"><code># calculate dispersion

1916.5/1118</code></pre>
<pre><code>## [1] 1.714222</code></pre>
<pre class="r fold-hide"><code># 1.74 is high so over-dispersed - use negative binomial</code></pre>
</div>
<div id="data-exploration" class="section level1">
<h1>5 Data exploration</h1>
<p>Then complete the data exploration steps below</p>
<ul>
<li>Generate plots of your potential explanatory variables and determine
which are useful (provide annotation of why some are not useful)</li>
<li>From the selected candidate explanatory variables check for
multicolinearity between variables and make note of which variables are
highly correlated and the r2 value.</li>
</ul>
<pre class="r fold-hide"><code># using purr
bear_damage_tidy %&gt;% 
  
  filter(damage == &#39;1&#39;) %&gt;% 
  
  select_if(is.numeric) %&gt;% 
  
  # use imap which will retain both the data (x) and the variable names (y)
  imap(~.x %&gt;% 
        
         # use the hist function on the data from previous pipe
        hist(.,
             
             # set the main title to y (each variable)
             main = .y))</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-5-1.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-2.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-3.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-4.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-5.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-6.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-7.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-8.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-9.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-10.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-11.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-12.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-13.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-14.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-15.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-16.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-17.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-18.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-19.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-5-20.png" width="672" /></p>
<pre><code>## $point_x
## $breaks
##  [1] 480000 500000 520000 540000 560000 580000 600000 620000 640000 660000
## 
## $counts
## [1]  1  3 27 89 55 11  1  5  6
## 
## $density
## [1] 2.525253e-07 7.575758e-07 6.818182e-06 2.247475e-05 1.388889e-05
## [6] 2.777778e-06 2.525253e-07 1.262626e-06 1.515152e-06
## 
## $mids
## [1] 490000 510000 530000 550000 570000 590000 610000 630000 650000
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $point_y
## $breaks
##  [1] 440000 460000 480000 500000 520000 540000 560000 580000 600000 620000
## 
## $counts
## [1]  1 13 24 63 24 30 25 14  4
## 
## $density
## [1] 2.525253e-07 3.282828e-06 6.060606e-06 1.590909e-05 6.060606e-06
## [6] 7.575758e-06 6.313131e-06 3.535354e-06 1.010101e-06
## 
## $mids
## [1] 450000 470000 490000 510000 530000 550000 570000 590000 610000
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $bear_abund
## $breaks
##  [1]  0  5 10 15 20 25 30 35 40 45 50 55 60
## 
## $counts
##  [1]  3  2  4 16 33 18 29 25 21  9 21 17
## 
## $density
##  [1] 0.003030303 0.002020202 0.004040404 0.016161616 0.033333333 0.018181818
##  [7] 0.029292929 0.025252525 0.021212121 0.009090909 0.021212121 0.017171717
## 
## $mids
##  [1]  2.5  7.5 12.5 17.5 22.5 27.5 32.5 37.5 42.5 47.5 52.5 57.5
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $altitude
## $breaks
## [1]  200  400  600  800 1000 1200 1400 1600
## 
## $counts
## [1]  2 16 69 60 32 15  4
## 
## $density
## [1] 5.050505e-05 4.040404e-04 1.742424e-03 1.515152e-03 8.080808e-04
## [6] 3.787879e-04 1.010101e-04
## 
## $mids
## [1]  300  500  700  900 1100 1300 1500
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $human_population
## $breaks
##  [1]   0  20  40  60  80 100 120 140 160 180
## 
## $counts
## [1] 182  11   0   0   2   1   0   0   2
## 
## $density
## [1] 0.0459595960 0.0027777778 0.0000000000 0.0000000000 0.0005050505
## [6] 0.0002525253 0.0000000000 0.0000000000 0.0005050505
## 
## $mids
## [1]  10  30  50  70  90 110 130 150 170
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $dist_to_forest
## $breaks
##  [1]    0  100  200  300  400  500  600  700  800  900 1000
## 
## $counts
##  [1] 118  54  17   3   3   0   0   1   1   1
## 
## $density
##  [1] 5.959596e-03 2.727273e-03 8.585859e-04 1.515152e-04 1.515152e-04
##  [6] 0.000000e+00 0.000000e+00 5.050505e-05 5.050505e-05 5.050505e-05
## 
## $mids
##  [1]  50 150 250 350 450 550 650 750 850 950
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $dist_to_town
## $breaks
##  [1]    0 1000 2000 3000 4000 5000 6000 7000 8000 9000
## 
## $counts
## [1] 22 50 54 37 17  9  3  5  1
## 
## $density
## [1] 1.111111e-04 2.525253e-04 2.727273e-04 1.868687e-04 8.585859e-05
## [6] 4.545455e-05 1.515152e-05 2.525253e-05 5.050505e-06
## 
## $mids
## [1]  500 1500 2500 3500 4500 5500 6500 7500 8500
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $livestock_killed
## $breaks
##  [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0
## 
## $counts
##  [1] 95 36  0 14  0 29  0  9  0  5  0 10
## 
## $density
##  [1] 0.95959596 0.36363636 0.00000000 0.14141414 0.00000000 0.29292929
##  [7] 0.00000000 0.09090909 0.00000000 0.05050505 0.00000000 0.10101010
## 
## $mids
##  [1] 1.25 1.75 2.25 2.75 3.25 3.75 4.25 4.75 5.25 5.75 6.25 6.75
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $shannondivindex
## $breaks
##  [1] 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0
## 
## $counts
## [1]  7 19 39 45 45 25 15  2  1
## 
## $density
## [1] 0.17676768 0.47979798 0.98484848 1.13636364 1.13636364 0.63131313 0.37878788
## [8] 0.05050505 0.02525253
## 
## $mids
## [1] 0.3 0.5 0.7 0.9 1.1 1.3 1.5 1.7 1.9
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_arable
## $breaks
## [1]  0 10 20 30 40 50 60 70 80
## 
## $counts
## [1] 176   8   6   5   0   0   2   1
## 
## $density
## [1] 0.0888888889 0.0040404040 0.0030303030 0.0025252525 0.0000000000
## [6] 0.0000000000 0.0010101010 0.0005050505
## 
## $mids
## [1]  5 15 25 35 45 55 65 75
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_orchards
## $breaks
## [1] -1  0
## 
## $counts
## [1] 198
## 
## $density
## [1] 1
## 
## $mids
## [1] -0.5
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_pasture
## $breaks
## [1]  0 10 20 30 40 50 60 70 80
## 
## $counts
## [1] 117  29  10  25   3  10   3   1
## 
## $density
## [1] 0.0590909091 0.0146464646 0.0050505051 0.0126262626 0.0015151515
## [6] 0.0050505051 0.0015151515 0.0005050505
## 
## $mids
## [1]  5 15 25 35 45 55 65 75
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_ag_mosaic
## $breaks
##  [1]  0  5 10 15 20 25 30 35 40 45
## 
## $counts
## [1] 186   5   0   3   0   3   0   0   1
## 
## $density
## [1] 0.187878788 0.005050505 0.000000000 0.003030303 0.000000000 0.003030303
## [7] 0.000000000 0.000000000 0.001010101
## 
## $mids
## [1]  2.5  7.5 12.5 17.5 22.5 27.5 32.5 37.5 42.5
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_seminatural
## $breaks
## [1]  0  5 10 15 20 25 30 35
## 
## $counts
## [1] 172  10   1   7   1   6   1
## 
## $density
## [1] 0.173737374 0.010101010 0.001010101 0.007070707 0.001010101 0.006060606
## [7] 0.001010101
## 
## $mids
## [1]  2.5  7.5 12.5 17.5 22.5 27.5 32.5
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_deciduous
## $breaks
##  [1]   0  10  20  30  40  50  60  70  80  90 100
## 
## $counts
##  [1] 81  5  7  9 22 29 16  8 18  3
## 
## $density
##  [1] 0.040909091 0.002525253 0.003535354 0.004545455 0.011111111 0.014646465
##  [7] 0.008080808 0.004040404 0.009090909 0.001515152
## 
## $mids
##  [1]  5 15 25 35 45 55 65 75 85 95
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_coniferous
## $breaks
##  [1]  0 10 20 30 40 50 60 70 80 90
## 
## $counts
## [1] 118  20  11  10  13  10   8   6   2
## 
## $density
## [1] 0.059595960 0.010101010 0.005555556 0.005050505 0.006565657 0.005050505
## [7] 0.004040404 0.003030303 0.001010101
## 
## $mids
## [1]  5 15 25 35 45 55 65 75 85
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_mixedforest
## $breaks
##  [1]   0  10  20  30  40  50  60  70  80  90 100
## 
## $counts
##  [1] 158  15   8   6   3   3   3   0   1   1
## 
## $density
##  [1] 0.0797979798 0.0075757576 0.0040404040 0.0030303030 0.0015151515
##  [6] 0.0015151515 0.0015151515 0.0000000000 0.0005050505 0.0005050505
## 
## $mids
##  [1]  5 15 25 35 45 55 65 75 85 95
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_grassland
## $breaks
##  [1]  0 10 20 30 40 50 60 70 80 90
## 
## $counts
## [1] 96 30 38 18 10  5  0  0  1
## 
## $density
## [1] 0.0484848485 0.0151515152 0.0191919192 0.0090909091 0.0050505051
## [6] 0.0025252525 0.0000000000 0.0000000000 0.0005050505
## 
## $mids
## [1]  5 15 25 35 45 55 65 75 85
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_for_regen
## $breaks
##  [1]  0  5 10 15 20 25 30 35 40 45 50 55 60 65
## 
## $counts
##  [1] 128  26   9   7   8  10   2   3   3   0   0   1   1
## 
## $density
##  [1] 0.129292929 0.026262626 0.009090909 0.007070707 0.008080808 0.010101010
##  [7] 0.002020202 0.003030303 0.003030303 0.000000000 0.000000000 0.001010101
## [13] 0.001010101
## 
## $mids
##  [1]  2.5  7.5 12.5 17.5 22.5 27.5 32.5 37.5 42.5 47.5 52.5 57.5 62.5
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;
## 
## $prop_check
## $breaks
## [1]  80 100
## 
## $counts
## [1] 198
## 
## $density
## [1] 0.05
## 
## $mids
## [1] 90
## 
## $xname
## [1] &quot;.&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;</code></pre>
<pre class="r fold-hide"><code>summary(bear_damage_tidy)</code></pre>
<pre><code>##  damage       year         month      targetspp      point_x      
##  0:922   2012   :245   0      :922   alte  : 16   Min.   :491321  
##  1:198   2013   :160   9      : 42   ovine : 39   1st Qu.:547710  
##          2014   :142   6      : 38   bovine:143   Median :569859  
##          2015   :136   8      : 34   NA&#39;s  :922   Mean   :575292  
##          2009   :132   7      : 31                3rd Qu.:603439  
##          2016   :122   5      : 21                Max.   :658416  
##          (Other):183   (Other): 32                                
##     point_y         bear_abund    landcover_code    altitude     
##  Min.   :447121   Min.   : 0.00   311    :261    Min.   : 255.0  
##  1st Qu.:489899   1st Qu.:19.00   312    :254    1st Qu.: 697.0  
##  Median :519150   Median :31.00   313    :159    Median : 915.0  
##  Mean   :524433   Mean   :30.24   321    :135    Mean   : 917.8  
##  3rd Qu.:552545   3rd Qu.:42.00   231    :129    3rd Qu.:1124.0  
##  Max.   :628579   Max.   :77.00   211    : 80    Max.   :1707.0  
##                                   (Other):102                    
##  human_population  dist_to_forest     dist_to_town   livestock_killed
##  Min.   :  0.000   Min.   :   0.00   Min.   :    0   Min.   :0.0000  
##  1st Qu.:  0.000   1st Qu.:   0.00   1st Qu.: 1790   1st Qu.:0.0000  
##  Median :  0.000   Median :   0.00   Median : 2941   Median :0.0000  
##  Mean   :  2.546   Mean   : 253.24   Mean   : 3561   Mean   :0.5634  
##  3rd Qu.:  0.000   3rd Qu.:  87.58   3rd Qu.: 4770   3rd Qu.:1.0000  
##  Max.   :369.000   Max.   :7073.95   Max.   :13140   Max.   :7.0000  
##                                                                      
##  shannondivindex   prop_arable      prop_orchards  prop_pasture  
##  Min.   :0.0000   Min.   :  0.000   Min.   :0     Min.   : 0.00  
##  1st Qu.:0.5107   1st Qu.:  0.000   1st Qu.:0     1st Qu.: 0.00  
##  Median :0.7850   Median :  0.000   Median :0     Median : 0.00  
##  Mean   :0.7633   Mean   :  7.002   Mean   :0     Mean   : 8.88  
##  3rd Qu.:1.0451   3rd Qu.:  0.000   3rd Qu.:0     3rd Qu.:11.23  
##  Max.   :1.8951   Max.   :100.000   Max.   :0     Max.   :96.11  
##                                                                  
##  prop_ag_mosaic    prop_seminatural prop_deciduous   prop_coniferous  
##  Min.   : 0.0000   Min.   : 0.000   Min.   :  0.00   Min.   :  0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.000   1st Qu.:  0.00   1st Qu.:  0.000  
##  Median : 0.0000   Median : 0.000   Median :  3.13   Median :  6.774  
##  Mean   : 0.8042   Mean   : 1.753   Mean   : 27.40   Mean   : 24.417  
##  3rd Qu.: 0.0000   3rd Qu.: 0.000   3rd Qu.: 56.59   3rd Qu.: 45.989  
##  Max.   :42.9740   Max.   :44.391   Max.   :100.00   Max.   :100.000  
##                                                                       
##  prop_mixedforest prop_grassland   prop_for_regen     prop_check 
##  Min.   :  0.00   Min.   : 0.000   Min.   : 0.000   Min.   :100  
##  1st Qu.:  0.00   1st Qu.: 0.000   1st Qu.: 0.000   1st Qu.:100  
##  Median :  0.00   Median : 0.000   Median : 0.000   Median :100  
##  Mean   : 15.26   Mean   : 8.732   Mean   : 5.758   Mean   :100  
##  3rd Qu.: 22.11   3rd Qu.:13.614   3rd Qu.: 8.162   3rd Qu.:100  
##  Max.   :100.00   Max.   :86.540   Max.   :61.234   Max.   :100  
## </code></pre>
<pre class="r fold-hide"><code>plot(bear_damage_tidy$landcover_code)</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-5-21.png" width="672" /></p>
</div>
<div id="data-formatting" class="section level1">
<h1>6 Data formatting</h1>
<p>Please add ONE additional variable (column) that is based on one or
more of the variables already in the data. This must be an ecologically
relevant variable, for example human_population divided by dist_to_town
is not an ecologically relevant variable, but the binary hunting
variable from the cows data where years prior to hunting ban were coded
as ‘1’ and years after hunting ban ‘0’ is an ecologically relevant
variable generated from the existing data. <em>You cannot use the
hunting example as your variable, there are several possibilities here;
you may want to use the information from your data exploration to inform
this decision</em></p>
<pre class="r fold-hide"><code>bear_damage_tidy &lt;-  bear_damage_tidy %&gt;% 
  
  # add new column that groups all forest types 
  mutate(prop_forest = rowSums(across(c(prop_coniferous, 
                                      prop_deciduous,
                                      prop_mixedforest))))


summary(bear_damage_tidy$prop_forest)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   48.67   73.72   67.07   93.29  100.00</code></pre>
<pre class="r fold-hide"><code># view(bear_damage_tidy)</code></pre>
</div>
<div id="fit-some-models" class="section level1">
<h1>7 Fit some models</h1>
<p>Create a candidate set of 8-10 models that represent hypotheses about
what variables may explain your chosen response and fit these to a glm
with the appropriate distribution</p>
<ul>
<li>Scale all numeric explanatory variables in your models<br />
</li>
<li>One model must be a null model<br />
</li>
<li>One model must include an interaction term AND have an appropriate
analog model without an interaction term to compare the relevance of the
interaction<br />
</li>
<li>No global models (all non-correlated variables in one model)</li>
</ul>
<p><strong>Ensure these don’t include correlated variables and are not
overparameterized</strong></p>
<blockquote>
<p>Check that these models are fitting appropriately before proceeding
to question 7</p>
</blockquote>
<pre class="r fold-hide"><code># going to scale data first for ease of coding

bear_damage_tidy &lt;- bear_damage_tidy %&gt;% 
  
  # use mutate to change all numeric variables to scaled
  mutate_if(is.numeric, 
            scale)


# answers will vary - I&#39;ve done 3 for demonstration

bear_null &lt;- glm(damage ~ 1,
                 data = bear_damage_tidy,
                 family = &#39;binomial&#39;)

# interaction between distance to forest and distance to town (close to both town and forest would have high prob of damage)
bear_distance_i &lt;- glm(damage ~ dist_to_forest * dist_to_town,
                       data = bear_damage_tidy,
                 family = &#39;binomial&#39;)

# quick check that this model fit
summary(bear_distance_i)</code></pre>
<pre><code>## 
## Call:
## glm(formula = damage ~ dist_to_forest * dist_to_town, family = &quot;binomial&quot;, 
##     data = bear_damage_tidy)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7420  -0.7138  -0.5430  -0.2199   2.5861  
## 
## Coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  -1.1042     0.1433  -7.705 1.31e-14 ***
## dist_to_forest                1.6345     0.4750   3.441  0.00058 ***
## dist_to_town                  0.2209     0.2179   1.014  0.31070    
## dist_to_forest:dist_to_town   3.5312     0.7857   4.494 6.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1044.92  on 1119  degrees of freedom
## Residual deviance:  960.37  on 1116  degrees of freedom
## AIC: 968.37
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r fold-hide"><code># analog distance model w/o interaction
bear_distance &lt;- glm(damage ~ dist_to_forest +
                       dist_to_town,
                       data = bear_damage_tidy,
                 family = &#39;binomial&#39;)

# quick check that this model fit
summary(bear_distance)</code></pre>
<pre><code>## 
## Call:
## glm(formula = damage ~ dist_to_forest + dist_to_town, family = &quot;binomial&quot;, 
##     data = bear_damage_tidy)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9293  -0.7004  -0.5669  -0.3137   2.3822  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -1.69548    0.09292 -18.247  &lt; 2e-16 ***
## dist_to_forest -0.62093    0.18654  -3.329 0.000872 ***
## dist_to_town   -0.62435    0.10685  -5.843 5.12e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1044.92  on 1119  degrees of freedom
## Residual deviance:  991.73  on 1117  degrees of freedom
## AIC: 997.73
## 
## Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div id="model-selection" class="section level1">
<h1>8 Model selection</h1>
<p>Perform model selection on your candidate set of models and identify
the best fit model/s</p>
<pre class="r fold-hide"><code>model.sel(bear_null,
          bear_distance,
          bear_distance_i)</code></pre>
<pre><code>## Model selection table 
##                  (Int) dst_to_frs dst_to_twn dst_to_frs:dst_to_twn df   logLik
## bear_distance_i -1.104     1.6340     0.2209                 3.531  4 -480.183
## bear_distance   -1.695    -0.6209    -0.6243                        3 -495.865
## bear_null       -1.538                                              1 -522.462
##                   AICc delta weight
## bear_distance_i  968.4  0.00      1
## bear_distance    997.8 29.35      0
## bear_null       1046.9 78.53      0
## Models ranked by AICc(x)</code></pre>
</div>
<div id="check-model-assumptions" class="section level1">
<h1>9 Check model assumptions</h1>
<p>This section will vary depending on the response variable you chose,
variables you included in your models, etc. So I’m not specifying
particular code to run, re-visit the GLM lab and other stats resources
if needed to ensure you’ve answered the following question adequately
with both code and a written response</p>
<ul>
<li>Check if your model violates any assumptions<br />
</li>
<li>For each assumption have a brief annotation explaining what you’re
testing and the conclusion you’ve drawn</li>
</ul>
<blockquote>
<p>If your model appears to violate any assumptions you don’t need to
re-run it, just proceed</p>
</blockquote>
<pre class="r fold-hide"><code># check assumptions for top model

vif(bear_distance_i)</code></pre>
<pre><code>## there are higher-order terms (interactions) in this model
## consider setting type = &#39;predictor&#39;; see ?vif</code></pre>
<pre><code>##              dist_to_forest                dist_to_town 
##                    4.770770                    3.652366 
## dist_to_forest:dist_to_town 
##                    7.012544</code></pre>
<pre class="r fold-hide"><code># plot VIF
vif(bear_distance_i) %&gt;%
  
  # Converts the named vector returned by vif() into a tidy tibble
  enframe(name = &#39;Predictor&#39;, 
          value = &#39;VIF&#39;) %&gt;%
  
  # plot with ggplot
  ggplot(aes(x = reorder(Predictor, VIF), # reorders from smallest VIF to largest (not sure I want like this)
             y = VIF)) +
  
  # plot as bars
  geom_bar(stat = &#39;identity&#39;, fill = &#39;skyblue&#39;) +
  
  # add labels
  labs(x = &#39;Predictor&#39;,
       y = &#39;VIF&#39;) +
  
  # set theme
  theme_classic()</code></pre>
<pre><code>## there are higher-order terms (interactions) in this model
## consider setting type = &#39;predictor&#39;; see ?vif</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r fold-hide"><code># dispersion
summary(bear_distance_i)</code></pre>
<pre><code>## 
## Call:
## glm(formula = damage ~ dist_to_forest * dist_to_town, family = &quot;binomial&quot;, 
##     data = bear_damage_tidy)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7420  -0.7138  -0.5430  -0.2199   2.5861  
## 
## Coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  -1.1042     0.1433  -7.705 1.31e-14 ***
## dist_to_forest                1.6345     0.4750   3.441  0.00058 ***
## dist_to_town                  0.2209     0.2179   1.014  0.31070    
## dist_to_forest:dist_to_town   3.5312     0.7857   4.494 6.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1044.92  on 1119  degrees of freedom
## Residual deviance:  960.37  on 1116  degrees of freedom
## AIC: 968.37
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r fold-hide"><code>960.37/1116 # 0.86 slightly under dispersed but not a major issue for glm</code></pre>
<pre><code>## [1] 0.8605466</code></pre>
<pre class="r fold-hide"><code># check for observations with high leverage
plot(bear_distance_i) # ignore first three</code></pre>
<p><img src="assign_4_files/figure-html/unnamed-chunk-9-2.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-9-3.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-9-4.png" width="672" /><img src="assign_4_files/figure-html/unnamed-chunk-9-5.png" width="672" />
&gt; VIFs are highish for individual terms which could indicate more
substantial violation of independence</p>
</div>
<div id="interpret-results" class="section level1">
<h1>10 Interpret results</h1>
<p>In bullet-point format provide annotations (comments) AND code (where
necessary) that answer the following questions</p>
<ul>
<li>Do you have a singular best-fit model and why or why not?<br />
</li>
<li>Was the interaction term useful? How do you know?</li>
</ul>
<p>For your best-fit model (if you don’t have an obvious singular model
pick one of the competitive models) and answer the questions below for
that model:</p>
<ul>
<li>What variable/s best explain the variation in your response? How do
you know?<br />
</li>
<li>Is this model a good fit to the data? How do you know?</li>
</ul>
</div>
<div id="caveats" class="section level1">
<h1>11 Caveats</h1>
<p>In bullet-point format provide annotations (comments) that speak to
possible factors of the data, modeling approach, etc. which could
contribute to uncertainty with your model selection, fit, and how you
could improve this analysis</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
