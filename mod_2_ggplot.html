<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Basics of ggplot" />

<meta name="date" content="2024-03-18" />

<title>Data Visualization</title>

<script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Crash Course 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Intro to R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_R101.html">Module 1: R 101</a>
    </li>
    <li>
      <a href="mod_2_baseR.html">Module 2: Base R</a>
    </li>
    <li>
      <a href="mod_3_data.html">Module 3: Working with data</a>
    </li>
    <li>
      <a href="mod_4_data_manipulation.html">Module 4: Data manipulation</a>
    </li>
    <li>
      <a href="mod_5_purrr.html">Module 5: The wonders of Purrr</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_plots_baseR.html">Module 1: Data Visualization in Base R</a>
    </li>
    <li>
      <a href="mod_2_ggplot.html">Module 2: Basics of ggplot</a>
    </li>
    <li>
      <a href="mod_3_ggplot_adv.html">Module 3: Advanced ggplot (coming soon)</a>
    </li>
    <li>
      <a href="mod_4_beyond_ggplot.html">Module 4: Beyond ggplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Modeling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mod_1_lm.html">Module 1: Linear regression (coming soon)</a>
    </li>
    <li>
      <a href="mod_2_glm.html">Module 2: Generalized linear models (GLMs)</a>
    </li>
    <li>
      <a href="mod_3_glmm.html">Module 3: General mixed effects models (GLMMs) (coming soon)</a>
    </li>
    <li>
      <a href="mod_4_occ.html">Module 4: Occupancy models (coming soon)</a>
    </li>
    <li>
      <a href="mod_5_sem.html">Module 5: Structural equation models (SEMs) (under construction)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Git
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Getting started with GitHub (under construction)</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="assign_1.html">Assignment 1</a>
    </li>
    <li>
      <a href="assign_2.html">Assignment 2</a>
    </li>
    <li>
      <a href="assign_3.html">Assignment 3</a>
    </li>
    <li>
      <a href="assign_4.html">Assignment 4</a>
    </li>
    <li>
      <a href="assign_5.html">Assignment 5</a>
    </li>
    <li>
      <a href="assign_6.html">Assignment 6</a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="links.html">Links</a>
</li>
<li>
  <a href="surveys.html">Surveys</a>
</li>
<li>
  <a href="terms.html">Terms</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Visualization</h1>
<h4 class="author">Basics of ggplot</h4>
<h4 class="date">18 March 2024</h4>

</div>


<p>Visualization often plays a major role in the research process, from
quality assurance, to data exploration, to the presentation of
results.</p>
<p>The data visualization package <em>ggplot2</em> makes it very easy
and straightforward to create a lot of different types of plots, from
simple to complex. In this module, we’ll introduce ggplot syntax and
briefly survey some of the package’s plotting capabilities.</p>
<div id="materials" class="section level2">
<h2>Materials</h2>
<div id="script" class="section level3">
<h3>Script</h3>
<ol style="list-style-type: decimal">
<li><p>Click <a href="mod_2_ggplot.R">here</a> to download the script.
Save the script to the scripts folder (R Project folder).</p></li>
<li><p>Load your script in RStudio. To do this, open RStudio and click
the <strong>files</strong> window and select the scripts folder and then
this script.</p></li>
</ol>
</div>
<div id="cheat-sheets" class="section level3">
<h3>Cheat sheets</h3>
<p>A good ggplot cheat sheet can be found here: <a
href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot
cheat sheet</a></p>
<p>Let’s get started plotting!</p>
</div>
</div>
<div id="ggplot-syntax" class="section level2">
<h2>ggplot syntax</h2>
<p>A typical workflow begins with initiating plotting with the
<code>ggplot()</code> function and specifying the data frame you want to
use to create your visualizations. We then often define the “x” argument
(defining coordinates on an x axis) and (if applicable) a “y” argument
(defining coordinates on a y axis). In ggplot these are known as
<strong>aesthetic mappings</strong>. That is because it is a way of
conveying information in the dataset graphically! Other ways of
conveying information graphically include point size, color, and symbol-
all of which are also referred to as aesthetic mappings (syntax:
<code>mapping=aes()</code>).</p>
<p>You can then add <strong>geometric objects</strong> (like points) to
your plot, often using functions beginning with <code>geom_</code>, to
represent your data in the form of a boxplot
(<code>geom_boxplot()</code>), scatterplot (<code>geom_point()</code>),
or a variety of other types of plots. The <code>aes()</code> function
can be called within these “geoms” to specify which variables to display
and how these data should be displayed (which data should be used to
represent the bar height, or the x coordinate, or the point size, etc.).
<code>aes()</code> can also be used within the initial call to
<code>ggplot()</code>.</p>
<p>Below is a bare bones template of the code you need to start a plot
in <em>ggplot</em>. All additions to the plot are added using
<code>+</code>.</p>
<pre class="r"><code>ggplot(data, aes(x = x_variable, y = y_variable)) +
  geom_chooseGeom</code></pre>
</div>
<div id="geoms" class="section level2">
<h2>Geoms</h2>
<p>The plot type is defined by the <strong>geometric objects</strong> or
<strong>geoms</strong> for short. The <strong>geom</strong> is specified
after the <code>ggplot()</code> function and as with all
additions/changes is added to the code chunk using <code>+</code>.</p>
<p>To illustrate this, let’s use the built in <code>iris</code> dataset,
which gives the sepal length/width and petal length/width (in cm), for
50 flowers from each of 3 iris species. Let’s go through a few common
geoms:</p>
<div id="scatterplots" class="section level3">
<h3>Scatterplots</h3>
<p>Here is an example of a simple scatterplot in ggplot:</p>
<pre class="r"><code># Scatterplots ----------------------------

ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) + # define the data and x and y axis
  
  # add the points
  geom_point()</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<blockquote>
<p>Remember R will read things in the order shown in the <strong>R
documentation</strong> for a given <strong>function</strong> if you
don’t specify which arguments you have provided, this can shorten your
code but can also make it confusing for others/cause errors if not
anotated properly.</p>
</blockquote>
<p><span style="color: blue;">Check the <strong>R documentation</strong>
for <code>ggplot()</code></span> to see how we could shorten the code
above</p>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>I generally work my way through each graph step-by-step running the
code after each addition to make sure it’s doing what I want. I find it
a lot easier to troubleshoot and make changes to my plots this way.
Let’s try this with the code above. <span style="color: blue;">Start by
running just the first line of code (from ggplot to the end of the
second ‘)’</span>.</p>
<p>What do you get?</p>
<p>An empty plot right! That’s because we haven’t specified the
<em>geom</em> yet. <span style="color: blue;">Now add the second line of
code</span> and run it. <em>don’t forget the <code>+</code></em>.</p>
<p>You get the full plot again! This plot is really simple so it may not
seem super helpful yet but it can be really useful as your plots get
more complicated to run your code after each addition. <em>And don’t
forget your coding best practices here!</em>. Be sure to put each
addition on it’s own line and even argument within an addition to make
your code easier to read and follow.</p>
</div>
<div id="box-whisker-and-violin-plots" class="section level3">
<h3>Box-whisker and violin plots</h3>
<p>Boxplots and violin plots are useful for display data for
<strong>factors</strong> (e.g., group, treatment, etc.)</p>
<pre class="r"><code># Box-whisker plots  -----------------------

# box-whisker plot
ggplot(iris, aes(x = Species, y = Sepal.Length)) +    
  geom_boxplot() </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># violin plot
ggplot(iris, aes(x = Species, y = Sepal.Length)) +    
  geom_violin() </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<p>Notice are violin plot doesn’t display any lines to show the mean,
median, or quantiles for the data which could be helpful. <span
style="color: blue;">Use the help function to look up the <strong>R
documentation</strong> for <code>geom_violin()</code></span> to see how
we could add some more information to this graph.</p>
<p><span style="color: blue;">Then adapt the code above to add quantiles
to the plot</span>.</p>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="bar-plots" class="section level3">
<h3>Bar plots</h3>
<p>Bar charts are useful for displaying count data associated with
<strong>factors</strong>.</p>
<p>Below is code to simply display the number of rows for each species
in the <em>iris</em> dataset</p>
<pre class="r"><code>  # Bar plots ----------------------

ggplot(iris, aes(x = Species)) + # we don&#39;t specify a y variable if we want sample size
  geom_bar()</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Notice we didn’t specify a ‘y’ variable above, if no ‘y’ variable is
specified <code>geom_bar()</code> will automatically map counts of each
x variable to the y-axis. This is useful for checking sample size.</p>
<p>This graph is kind of ugly since all the species have the same sample
size, but we can make it look a little nicer by changing the width of
the bars</p>
<pre class="r"><code># bar plot with width specified

ggplot(iris, aes(x = Species)) + # we don&#39;t specify a y variable if we want sample size
  geom_bar(width = 0.5)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>This is okay for now. We will go over many more options to make plots
look nicer.</p>
<p>If we want to display variables from our data on both the x and y
axis we can use <code>geom_col()</code>.</p>
<p><span style="color: blue;"> Create a new data frame from the iris
data called bar_heights and calculate the mean sepal length of each iris
species, assign this the name meanSL in the data </span>.</p>
<pre class="r"><code># create plot of mean sepal length for each species
ggplot(bar_heights, aes(Species, meanSL)) +
  
  # add bars
  geom_col(width = 0.5)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We can also pipe the data directly into ggplot to avoid assigning an
unnecessary object to the environment. <span style="color: blue;">Try
adapting the code above to do this on your own </span>.</p>
<pre class="r fold-hide"><code># do some data manipulation to get data frame with mean sepal length per species
iris %&gt;% 
  
  # group by species to calculate a mean for each
  group_by(Species) %&gt;% 
  
  # use summarize to calculate a mean of Sepal length and assign it to a column called mean_sepal_L
  summarize(meanSL = mean(Sepal.Length)) %&gt;% 
  
  # ungroup and pipe into ggplot function
  ungroup() %&gt;% 
  
ggplot(., aes(x = Species, y = meanSL)) +
  
  # plot bar graph
  geom_col(width = 0.5)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div id="error-bars" class="section level4">
<h4>Error bars</h4>
<p>But what if we want to have some error bars? We can add another
<strong>geom</strong> to our code chunk to add error bars to the
graph.</p>
<pre class="r"><code>  # Bar plots with error bars ----------------------

# first we need to add a few calculations to our summary data for this graph
bar_heights &lt;- iris %&gt;% 
  
    # create groups for each species
  group_by(Species) %&gt;% 
  
  # calculate mean, sample size (n), sd, and SE for each species sepal length
  summarize(meanSL = mean(Sepal.Length),
            n = n(),
            sdSL = sd(Sepal.Length),
            se = sdSL/sqrt(n)) # there isn&#39;t a function for SE so we have to write our own

# plot mean and SE sepal length for each species
ggplot(bar_heights, aes(x = Species, y = meanSL)) + 
  
  # add columns
  geom_col(width = 0.5) +
  
  # add error bars
  geom_errorbar(aes(ymin = meanSL - 2*sdSL, # ymin specifies the lower limit of the error bar
                    ymax = meanSL + 2*sdSL), # ymax specifies the upper limit of the error bar
                width = 0.2) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="viewingsavingexporting-plots" class="section level2">
<h2>Viewing/saving/exporting plots</h2>
<div id="saving-plots-to-environment" class="section level3">
<h3>Saving plots (to environment)</h3>
<p>As with anything else you want saved to your
<strong>environment</strong>, you can save plots using the *assignment
operator** (<code>&lt;-</code>). <span style="color: blue;">Create a
simple plot using the <em>iris</em> data and save it to your
<strong>environment</strong> as ‘plot_t’</span>.</p>
<p>What happens?</p>
<p>Nothing!</p>
<p>That’s because as with anything else you save to the
<strong>environment</strong> you have to print/view it in order to see
the object. <span style="color: blue;">In your <strong>console</strong>
type ‘plot_1’ and hit enter</span>.</p>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Now the plot window will open and your plot is visible.</p>
<blockquote>
<p>Don’t forget this step! It is easy to do and leave you stuck
wondering what was wrong with your code when all you need to do is print
your plot</p>
</blockquote>
</div>
<div id="exporting-plots" class="section level3">
<h3>Exporting plots</h3>
<p>You will often want to export your plots out of R for use in
presentations, publications, etc. The <code>ggsave()</code>
<strong>function</strong> exports plots. Let’s take a look at the
<strong>R documentation</strong> for <code>ggsave()</code>.</p>
<pre class="r"><code>  # Export plots ----------------------

?ggsave()

# save plot_1

ggsave(&#39;iris_plot_1.tiff&#39;,
       plot_1,
       path = &#39;figures&#39;)</code></pre>
<p>Inside the <code>ggsave()</code> <strong>function</strong> we can
alter the size, file type, dpi, and much more of our graph with just a
few lines of code, making this a very useful tool when creating high
quality figures.</p>
</div>
<div id="combiningviewing-multiple-plots" class="section level3">
<h3>Combining/viewing multiple plots</h3>
<p>Just like in <strong>base R</strong> we may want to view multiple
plots in the same window, you can use the same functions we learnedin
the last module, or using the <em>ggpubr</em> <strong>package</strong>.
This <strong>package</strong> is a commonly used extension of
<em>ggplot</em></p>
<p>The <code>ggarrange()</code> <strong>function</strong> in the
<em>ggpubr</em> <strong>package</strong> will allow us to view multiple
plots saved to our <strong>environment</strong> in the same window. Here
we explore different ways of graphically representing the relationship
between tree girth and volume.</p>
<p>First let’s make 4 graphs of the <em>iris</em> data with different
<strong>geoms</strong>.</p>
<pre class="r"><code>  # Combining plots ----------------------

# Explore different geoms with iris data

  # plot the relationship as a line
plot1 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add line
  geom_line()

# plot a smoothed &quot;spline&quot; fit of the relationship
plot2 &lt;- ggplot(iris ,aes(Petal.Length, Petal.Width)) + 
  
  # add smoothed line
  geom_smooth()

# plot scatterplot
plot3 &lt;- ggplot(iris ,aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point() 

   # plot scatterplot with smoothed regression line
plot4 &lt;- ggplot(iris ,aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point() + 
  
  # add regression line
  geom_smooth()</code></pre>
<p>Now lets use the <code>ggarrange()</code><strong>function</strong> to
view them all at once</p>
<pre class="r"><code>ggarrange(plot1,
          plot2,
          plot3,
          plot4,
          labels = &quot;auto&quot;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>We can also use this function to combine plots and export them as one
image. For example:</p>
<pre class="r"><code>figure_1 &lt;- ggarrange(plot1, plot2, plot3, plot4,
                      labels = c(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;),
                      ncol = 2,
                      nrow = 2)

figure_1</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code># save to hard drive
# ggsave(&#39;figure_1.tiff&#39;, 
#        figure_1,
#        path = &#39;figures&#39;)</code></pre>
<p>We can also alter the arrangement so one plot takes up the whole
width and the other plots are split by nesting the
<code>ggarrange()</code> <strong>functions</strong>.</p>
<pre class="r"><code>ggarrange(plot4,
          nrow = 2,
          labels = &#39;D&#39;,
          ggarrange(plot1, plot2, plot3,
                    ncol = 3,
                    labels = c(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;)))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Not the most elegant but it works.</p>
<p>There’s tons you can do with <code>ggarrange()</code> and you can
check out the tutorial below if you are interested in learning more.</p>
<p><a
href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page/">Tutorial
for combining graphs</a></p>
</div>
</div>
<div id="changing-aesthetics" class="section level2">
<h2>Changing aesthetics</h2>
<p>If you want convey information in your data via the color, symbol, or
point size, you include it as an aesthetic mapping- and link it to one
of the columns in your data.</p>
<p>If you just want to color all the points the same way, or use the
same symbol for everything, specify this outside of the aesthetic
mapping.</p>
<p>Let’s go through a few examples changing various
<strong>aesthetics</strong></p>
<div id="color" class="section level3">
<h3>Color</h3>
<p>Color is specified using the <code>color=</code> or <code>col=</code>
option.</p>
<p>Let’s try adding color to the points in our scatterplot, there are a
few different ways we can do this:</p>
<pre class="r"><code>  # Changing aesthetics----------------------

  # Color----------------------

# single color for all points by name
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points by name
  geom_point(col = &#39;blue&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># single color for all points by hex code
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add colored points by hex code
  geom_point(col = &#39;#33A5FF&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>What about this?</p>
<pre class="r"><code># single color for all points by name
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add colored points by name
  geom_point(aes(col = &#39;blue&#39;))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>What happened here? The dots aren’t blue…. but we have a legend that
says colour with ‘blue’ listed.</p>
<p>This is because we added the color argument INSIDE the
<strong>aesthetics</strong> (<code>ase()</code>), so R is looking for a
variable called blue to determine how to color the points but since
there isn’t a variable called blue this is what we get instead. This is
a super common mistake I’ve done this countless times, so if your plot
turns out like this now you know what to do.</p>
<p>Let’s look at an example of this using an actual variable in our
dataset</p>
<pre class="r"><code> # try representing tree species using color
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by species
  geom_point(aes(col = Species))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>What happens if we forget to specify the aesthetics and try to color
the points by species, this is a super common mistake I see.</p>
<pre class="r"><code> # try representing tree species using color
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by species
  geom_point(col = Species)</code></pre>
<p>In the first two examples we chose specific colors for our points.
You can identify colors by their name. There are tons of colors for
ggplot and you may. find it useful to save a list such as below for
future use.</p>
<p>You can download this one <a
href="images/colorbynames.png">here</a>.</p>
<p><img src="images/colorbynames.png" /> You can also use <strong>hex
codes</strong>. If you aren’t familiar with <strong>hex codes</strong>
are used in web development and are a a hex code is a representation of
how much red, green, and blue exist in a color. A <strong>hex
code</strong> consists of six characters and in R is preceded by a ‘#’.
Below are a few helpful links to get you started using <strong>hex
codes</strong>.</p>
<p><a href="https://htmlcolorcodes.com/">Hex color picker</a><br />
<a
href="https://chrome.google.com/webstore/detail/colorpick-eyedropper/ohcpnigalekghcmgcdcenkpelffpdolg">ColorPick
Eyedropper Chroe extension</a></p>
</div>
<div id="shape" class="section level3">
<h3>Shape</h3>
<p>Point shape is specified using the <code>shape=</code> option. We can
change the shape of any points on a plot including dot-whisker plots,
scatterplots, etc.</p>
<p>Similar to the color argument, we can specify the shape of all points
are set the shape to be based on some variable in the dataset.</p>
<pre class="r"><code>  # Shape----------------------

# changing point shape

# set all points to a specified shape
ggplot(iris, aes(Sepal.Length, Petal.Length)) +
  
  # add points
  geom_point(shape = 2)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code># change shape based on variable in data
ggplot(iris, aes(Sepal.Length, Petal.Length)) +
  
    # shape represents species
  geom_point(aes(shape = Species))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
</div>
<div id="fill" class="section level3">
<h3>Fill</h3>
<p><code>fill</code> is similar to <code>col</code> in that it will add
color to a plot, however <code>col</code> only adds a border of color
around a shape on the plot while <code>fill</code> colors in the entire
thing. <code>fill</code> is applicable when using bar graphs as it will
fill in the bar, it does not work for lines graphs or scatterplots
because the shapes cannot be ‘filled in’.</p>
<p>Let’s see what this looks like with the <em>iris</em> dataset.</p>
<pre class="r"><code>  # Fill ----------------------

# using fill to color points

# comparing color to fill

# color
ggplot(iris, aes(Sepal.Length, Petal.Length)) +
  
  # add points
  geom_point(shape = 2,
             col = &#39;blue&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code># fill
ggplot(iris, aes(Sepal.Length, Petal.Length)) +
  
  # add points
  geom_point(shape = 2,
             fill = &#39;blue&#39;) # notice this didn&#39;t work because points can&#39;t be filled in </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre class="r"><code># let&#39;s try with bar graphs instead

# color
ggplot(bar_heights, aes(Species, meanSL)) +
  
  # add bars
  geom_col(col = &#39;blue&#39;) # notice just the border is blue</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
<pre class="r"><code># fill
ggplot(bar_heights, aes(Species, meanSL)) +
  
  # add bars
  geom_col(fill = &#39;blue&#39;) # now the whole bar is blue</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-27-4.png" width="672" /></p>
<pre class="r"><code># change fill based on variable in data
ggplot(bar_heights, aes(Species, meanSL)) +
  
  # add bars
  geom_col(aes(fill = Species)) # bar color varies by species</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-27-5.png" width="672" /></p>
<p>You’ll notice there’s a lot of repetition in the code to change
various <strong>aesthetics</strong>, this is one of the nice things
about <em>ggplot</em> it makes it easy to use and remember syntax
because it’s very similar among <strong>aesthetics</strong>.</p>
</div>
<div id="size" class="section level3">
<h3>Size</h3>
<p>Size is specified using the <code>size=</code> option.</p>
<pre class="r"><code>  # Size ----------------------


ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  
  # size represents species
  geom_point(aes(size = Species)) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code># size is same across the board
ggplot(iris, aes(Sepal.Length, Petal.Length)) +    
  geom_point(size = 2) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
</div>
</div>
<div id="scales" class="section level2">
<h2>Scales</h2>
<p><strong>Scales</strong> control the mapping from data to
<strong>aesthetics</strong> and allow us to change the mapping of data.
If this doesn’t make sense right away that’s okay, we will go through
some examples.</p>
<div id="manually-set-aesthetics" class="section level3">
<h3>Manually set aesthetics</h3>
<p>Often the colors <em>ggplot</em> chooses or the labels in the legend
(e.g., what we’ve named things in the data) aren’t the best. We can
manually change these using manual <strong>scales</strong>. Let’s use
our code from above where we represent each iris species with different
colors:</p>
<pre class="r"><code>  # Scales ----------------------

# manual color

 # try representing iris species using color
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by height
  geom_point(aes(color = Species)) +
  
  # specify colors 
  scale_color_manual(name = &#39;Iris Species&#39;, # this changes the legend title
                     values = c(&#39;#BD6BF1&#39;, &#39;#3829A3&#39;, &#39;#9498D8&#39;), # I selected these hex codes using the ColorPick Eyedropper and googline images of each iris species :)
                     labels = c(&#39;I. setosa&#39;, &#39;I. versicolor&#39;, &#39;I. virginica&#39;)) # this changes the labels inside the legend, these must be in the same order as the data and the colors you want for each</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>With the code above I was able to set colors of my choice for each of
the species in the plot and change the title and labels in the
legend.</p>
<blockquote>
<p>It’s important to note that when you manually change the labels they
must be in the same order ass ggplot plots them. ggplot plots variables
in alphabetical/numerical order if you change the order in the
<code>values=</code> argument it won’t change the data it will just
label the wrong thing.</p>
</blockquote>
<p>If you want to change the order your data are plotted you can rename
your variables so that they alphabetically or numerically the one you
want first is plotted first, or you can look up ways to do this. Since
we don’t have time to cover it in this course here is a useful link:</p>
<p><a
href="https://r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html">Reorder
variable with ggplot2</a></p>
</div>
<div id="gradients" class="section level3">
<h3>Gradients</h3>
<p>What if we want to represent colors for a numeric variable as a
gradient. If we plot a numeric variable to the color aesthetics of a
<strong>geom</strong> R will automatically set a gradient.</p>
<p>Let’s use the <em>trees</em> data for this. For example, let’s say we
want a color scheme where taller trees are represented by darker values
of the same color.</p>
<pre class="r"><code>  # color gradients ----------------------

# specify data and variables
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by petal length
  geom_point(aes(color = Petal.Length))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>However, as we saw before, sometimes sticking to the default colors
in ggplot isn’t the best choice. You might have factors representing
ordered ranks, like in an experiment with different levels of light
exposure, and want to represent these levels on a monochromatic scale.
Or you might want to make a map displaying regions of positive or
negative change in forest cover, using a diverging color scale. Or you
don’t even like the default ggplot colors, and have your own preferred
color schemes. It’s also important to remember that red-green
colorblindness is fairly common, so if you are presenting data that must
be distinguished by colors in a single plotting area, you should
probably avoid this combination or combine it with changes in value
(light to dark) in order for your plot to be accessible.</p>
<p>One method is to use <code>scale_*_gradient</code>.</p>
<pre class="r"><code># specify color gradient with scales

# specify data and variables
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by petal length
  geom_point(aes(color = Petal.Length)) +
  
  # set scales
  scale_color_gradient(low = &#39;yellow&#39;,
                       high = &#39;green&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>Not the best color choice but you get the idea.</p>
<p>Another method is to use an already composed color palette from
RColorBrewer (a package you’ll need to install). You can check out all
of the options available in RColorBrewer by entering
<strong><code>display.brewer.all()</code></strong>, which shows the
sequential palettes, then categorical palettes, than diverging
palettes.</p>
<pre class="r"><code># Playing with colors in ggplot!

display.brewer.all()</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-32-1.png" width="576" /></p>
<p>I’m going to pick the YlGn (yellow green) palette, because those seem
like good plant colors. For a continuous variable we need to use
<code>scale_*_distiller()</code>.</p>
<pre class="r"><code># Choose a new color palette from the RColorBrewer package

# specify data and variables
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by petal length
  geom_point(aes(color = Petal.Length)) +
  
  # set scales
  scale_color_distiller(palette = &#39;YlGn&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>If we had discrete data (data binned) we could use
<code>scale_*_brewer()</code> in the same way.</p>
</div>
<div id="change-axis-range" class="section level3">
<h3>Change axis range</h3>
<p>Another thing we can do with <strong>scales</strong> is change
elements of our x and y-axis. Such as the range of values they show and
where the breaks occur.</p>
<p>Let’s change the range of values so our axis start at 0</p>
<pre class="r"><code>  # Axis ----------------------

ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by height
  geom_point(aes(color = Species)) +
  
  # specify colors and legend info
  scale_color_manual(name = &#39;Iris Species&#39;, 
                     values = c(&#39;#BD6BF1&#39;, &#39;#3829A3&#39;, &#39;#9498D8&#39;), 
                     labels = c(&#39;I. setosa&#39;, &#39;I. versicolor&#39;, &#39;I. virginica&#39;)) +
  
  # change axis breaks
  scale_x_continuous(limits = c(0, 8), # changes the range of values for x axis
                     breaks = seq(0, 8, by = 2)) + # sets the breaks (where the numbers are shown) alternatively could set breaks = c(0, 2, 4, 6, 8)
  
  scale_y_continuous(limits = c(0, 5),
                     breaks = seq(0, 5, by = 1))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>This wasn’t the best alteration for our graph since our data don’t
start near zero. <span style="color: blue;">Alter the code above to set
the x axis to go from 2-5 and y-axis 4-8 with breaks every 1
number</span>.</p>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<blockquote>
<p>There are lots of <strong>scales</strong> depending on what type of
variable you are working with and what you want to accomplish. The <a
href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot
cheat sheet</a> will be very helpful to explore more
<strong>scales</strong></p>
</blockquote>
</div>
</div>
<div id="changing-axis-titles-text" class="section level2">
<h2>Changing axis titles &amp; text</h2>
<div id="axis" class="section level3">
<h3>Axis</h3>
<p>Often the names we enter for are variables (which are what R uses as
the axis lables by default) are not very informative. We can change
these and other elements of the axis with a few simple commands.</p>
<p>Let’s keep adding to our graph from above to make it look nicer.</p>
<pre class="r"><code>  # Axis titles &amp; text----------------------

# change axis information

ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by height
  geom_point(aes(color = Species)) +
  
  # specify colors and legend info
  scale_color_manual(values = c(&#39;#BD6BF1&#39;, &#39;#3829A3&#39;, &#39;#9498D8&#39;), 
                     labels = c(&#39;I. setosa&#39;, &#39;I. versicolor&#39;, &#39;I. virginica&#39;)) +
  
  # change axis breaks
  scale_x_continuous(limits = c(4, 8), # changes the range of values for x axis
                     breaks = seq(4, 8, by = 1)) + # sets the breaks (where the numbers are shown) alternatively could set breaks = c(0, 2, 4, 6, 8)
  
  scale_y_continuous(limits = c(2, 5),
                     breaks = seq(2, 5, by = 1)) +
  
  labs(x = &#39;Sepal length (cm)&#39;,
       y = &#39;Sepal width (cm)&#39;,
       color = &#39;Iris species&#39;) # we can change the legend title here using the aesthetic name instead of in scales</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="titles-subtitles" class="section level3">
<h3>Titles &amp; subtitles</h3>
<p>If we have multiple plots together we can may want to add titles or
subtitiles:</p>
<pre class="r"><code>  # Titles ----------------------

# create vector for colors
iris_colors &lt;- c(&#39;#BD6BF1&#39;, &#39;#3829A3&#39;, &#39;#9498D8&#39;)

# create vector for labels
iris_labels &lt;- c(&#39;I. setosa&#39;, &#39;I. versicolor&#39;, &#39;I. virginica&#39;)

  # scatterplot
plot1 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) +
  
  # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
  labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Scat&#39;)

# plot a smoothed &quot;spline&quot; fit of the relationship
plot2 &lt;- ggplot(iris ,aes(Petal.Length, Petal.Width)) + 
  
  # add smoothed line
  geom_smooth(aes(color = Species)) +
  
   # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
    labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Linear regression&#39;)

# plot scatterplot
plot3 &lt;- ggplot(iris ,aes(Species, Petal.Length)) + 
  
  # add points
  geom_boxplot(aes(color = Species)) +
  
   # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
    labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Boxpl0t&#39;)

   # plot scatterplot with smoothed regression line
plot4 &lt;- ggplot(iris ,aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) + 
  
  # add regression line
  geom_smooth(aes(color = Species)) +
  
   # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
    # add labels
    labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Scatterplot with linear regression&#39;)


ggarrange(plot1,
          plot2,
          plot3,
          plot4,
          common.legend = TRUE,
          legend = &#39;right&#39;,
          labels = &#39;AUTO&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Let’s go over a few things I did above</p>
<ol style="list-style-type: decimal">
<li><p>I created two vectors, one for the colors I want in my graphs and
one for the species names. This can be very useful if you are going to
be making multiple graphs with the same elements. It saves you time
typing them out for every plot and reduces the chance of
errors.</p></li>
<li><p>I created four graphs with different <strong>geoms</strong> and
gave them all subtitles that say what kind of plot they are</p></li>
<li><p>I combined them using <code>ggarrange()</code> and specified that
all the plots can use the same legend, where I want the legend placed
(‘right’), and to create automatic <em>uppercase</em> labels
(A-D).</p></li>
</ol>
<p>If you want to check out more options for titles and subtitles the <a
href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot
cheat sheet</a> will be a good starting place.</p>
</div>
</div>
<div id="themes" class="section level2">
<h2>Themes</h2>
<p>You can see that the default plot includes a gray background with
white gridlines. This makes all of the elements on this plot easy to
see, but as you start adjusting colors and identifying your personal
preferences, you’ll probably want to customize this – ggplot has a ton
of options for doing so.</p>
<div id="preset-themes" class="section level3">
<h3>Preset themes</h3>
<p>Here’s a few examples of ggplot <strong>themes</strong>:</p>
<pre class="r fold-hide"><code>  # Themes ----------------------

# explore themes 

# scatterplot theme bw
theme1 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) +
  
  # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
  labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Theme bw&#39;) +
  
  # add theme
  theme_bw()

# scatterplot theme classic
theme2 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) +
  
  # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
  labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Theme classic&#39;) +
  
  # add theme
  theme_classic()

# scatterplot theme minimal
theme3 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) +
  
  # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
  labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Theme minimal&#39;) +
  
  # add theme
  theme_minimal()

# scatterplot theme dark
theme4 &lt;- ggplot(iris, aes(Petal.Length, Petal.Width)) + 
  
  # add points
  geom_point(aes(color = Species)) +
  
  # specify colors and labels
  scale_color_manual(values = iris_colors,
                     labels = iris_labels) +
  
  # add labels
  labs(x = &#39;Petal length (cm)&#39;,
       y = &#39;Petal width (cm)&#39;,
       subtitle = &#39;Theme dark&#39;) +
  
  # add theme
  theme_dark()

ggarrange(theme1,
          theme2,
          theme3,
          theme4,
          common.legend = TRUE,
          legend = &#39;right&#39;)</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>There are many other themes are available in ggplot, cowplot and
other related packages</p>
</div>
<div id="manually-alter-themes" class="section level3">
<h3>Manually alter themes</h3>
<p>You can also manually change theme elements such as text size,
gridlines, border, etc.</p>
<pre class="r"><code>ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  
  # add points colored by height
  geom_point(aes(color = Species)) +
  
  # specify colors and legend info
  scale_color_manual(values = c(&#39;#BD6BF1&#39;, &#39;#3829A3&#39;, &#39;#9498D8&#39;), 
                     labels = c(&#39;I. setosa&#39;, &#39;I. versicolor&#39;, &#39;I. virginica&#39;)) +
  
  # change axis breaks
  scale_x_continuous(limits = c(4, 8), # changes the range of values for x axis
                     breaks = seq(4, 8, by = 1)) + # sets the breaks (where the numbers are shown) alternatively could set breaks = c(0, 2, 4, 6, 8)
  
  scale_y_continuous(limits = c(2, 5),
                     breaks = seq(2, 5, by = 1)) +
  
  labs(x = &#39;Sepal length (cm)&#39;,
       y = &#39;Sepal width (cm)&#39;,
       color = &#39;Iris species&#39;) + # we can change the legend title here using the aesthetic name instead of in scales
  
  theme(axis.title.y = element_text(size = 14,                   # change size of y axis title text
                                    color = &#39;red&#39;),              # change color of y axis title text
        axis.title.x = element_text(size = 20),                  # change size of x axis title text
        axis.ticks = element_blank(),                            # remove all axis ticks
        panel.grid.major = element_line(colour = &#39;grey&#39;),        # change color of major gridlines
        panel.grid.minor = element_blank(),                      # remove minor gridlines
        panel.background = element_rect(fill = &#39;yellow&#39;),        # change panel background color
        panel.border = element_rect(fill = NA, color = &quot;black&quot;), # make pnael border black
        legend.position = &quot;top&quot;)                                 # move legend to top</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code># check out the theme documentation for more things you can change, the options are endless!
# ?theme</code></pre>
<p>This isn’t a very pretty graph but it demonstrates many of the
different things you can alter within the <code>theme()</code>
argument.</p>
<p>You can also set your own theme if you are going to use a lot of the
same formatting for a series of graphs. This is slightly more advanced
but very useful. Below is a tutorial I found for how to do this</p>
<p>(Create custom theme)[<a
href="https://rpubs.com/mclaire19/ggplot2-custom-themes"
class="uri">https://rpubs.com/mclaire19/ggplot2-custom-themes</a>]</p>
</div>
</div>
<div id="example-walkthrough" class="section level2">
<h2>Example walkthrough</h2>
<p>And for a slightly more complex example, let’s consider the built in
<code>ToothGrowth</code> data set, which looks at tooth growth in guinea
pigs under three different vitamin C doses and two different delivery
methods (orange juice or ascorbic acid).</p>
<pre class="r"><code>  # -Example walkthrough ---------------------

# ?ToothGrowth
head(ToothGrowth)</code></pre>
<pre><code>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</code></pre>
<p>First let’s get some summary data (mean, sd, and n) for each delivery
method (supp) that we may want to display in our graph.</p>
<pre class="r"><code># toothgrowth plot 

sumTC &lt;- ToothGrowth %&gt;% 
  
  # make dose a factor
  mutate(dose = as.factor(dose)) %&gt;% 
  
  # group by dose
  group_by(supp,dose) %&gt;% 
  
  # summarize mean and sd tooth length per group
  summarize(mean = mean(len),
            sd = sd(len),
            n = n())

sumTC</code></pre>
<pre><code>## # A tibble: 6 × 5
## # Groups:   supp [2]
##   supp  dose   mean    sd     n
##   &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1 OJ    0.5   13.2   4.46    10
## 2 OJ    1     22.7   3.91    10
## 3 OJ    2     26.1   2.66    10
## 4 VC    0.5    7.98  2.75    10
## 5 VC    1     16.8   2.52    10
## 6 VC    2     26.1   4.80    10</code></pre>
<p>Below is the graph we want to make which displays the mean, sd, for
each dose and delivery method with the mean values printed above each
bar.
<img src="mod_2_ggplot_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Let’s go through step-by-step how to make this graph.</p>
<p>First we need to call the <code>ggplot()</code>
<strong>function</strong> and supply the data and x and y variables.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>This gives us our empty plot with dose on the x-axis and mean one the
y-axis</p>
<p>Now let’s add the data using <code>geom_col()</code>.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean)) +
  
  # add data bars
  geom_col()</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>But we want our bars colored based on the ‘supp’ variable, and
outlined in black. Let’s add this in the<code>geom_col()</code>
argument.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean)) +
  
  # add data bars
  geom_col(aes(fill = supp),
           color = &#39;black&#39;) # remember since black isn&#39;t a variable in the data this argument goes OUTSIDE the aes()</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>This isn’t very helpful yet because it’s stacking the two groups on
top of one another. We can use a handy argument called
<code>position_dodge()</code> to fix this.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean)) +
  
  # add data bars
  geom_col(aes(fill = supp),
           color = &#39;black&#39;,
           position = position_dodge()) # this puts the groups side-by-side instead of stacked</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>Now lets add error bars to each bar.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean)) +
  
  # add data bars
  geom_col(aes(fill = supp),
           color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Whoops! What happened here?</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean,)) +
  
  # add data bars
  geom_col(aes(fill = supp),
           color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>We didn’t use <code>position_dodge()</code> on the error bars so they
plotted in the center of each dose. But there’s another issue here… this
one is tricky, because we didn’t specify a <em>fill</em> argument in the
<code>geom_errorbar()</code> it doesn’t know which color to put the
error bars on. We can fix this by specifying fill in the
<code>geom_errorbar()</code> argument.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean,)) +
  
  # add data bars
  geom_col(aes(fill = supp),
           color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd,
                    fill = supp),
                position = position_dodge(0.9),
                width = 0.2) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<pre class="r"><code># or a simpler way is to specify the fill in the entire plot aesthetics

# specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
<p>Now lets add the values of bar above them and don’t forget
<code>position_dodge()</code> so they line up properly</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean),
            position = position_dodge(width = 0.9))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>Those labels aren’t in the best spot. We can specify their
orientation in relation to the y - axis using the <code>y =</code>
argument.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean,
                 y = mean + (sd + 1)),
            position = position_dodge(width = 0.9))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Much better! Now let’s change the labels so they are a bit more
informative.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean,
                 y = mean + (sd + 1)),
            position = position_dodge(width = 0.9)) +
  
   # add labels
  labs(title = &quot;Tooth growth&quot;, 
       x= &quot;Dose (mg)&quot;, 
       y = &quot;Length (mm)&quot; ,
       fill = &#39;Delivery method&#39;) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Next let’s adjust the size of some of the text and other
<strong>theme</strong> elements so it is a bit more readbale and
pretty.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean,
                 y = mean + (sd + 1)),
            position = position_dodge(width = 0.9)) +
  
   # add labels
  labs(title = &quot;Tooth growth&quot;, 
       x= &quot;Dose (mg)&quot;, 
       y = &quot;Length (mm)&quot; ,
       fill = &#39;Delivery method&#39;) +
  
   # add theme
   theme_classic() +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14),
        plot.title = element_text(hjust = 0.5,
                                  size = 16),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 14)) </code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>Now let’s change these awful plotting colors.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean,
                 y = mean + (sd + 1)),
            position = position_dodge(width = 0.9)) +
  
   # add labels
  labs(title = &quot;Tooth growth&quot;, 
       x= &quot;Dose (mg)&quot;, 
       y = &quot;Length (mm)&quot; ,
       fill = &#39;Delivery method&#39;) +
  
   # add theme
   theme_classic() +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14),
        plot.title = element_text(hjust = 0.5,
                                  size = 16),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 14)) +
  
  # manually alter colors
   scale_fill_manual(values = c(&#39;#E69F00&#39;, &#39;#999999&#39;),
                     labels = c(&#39;Orange juice&#39;, &#39;Ascorbic acid&#39;))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Finally, I don’t like the awkward spacing between the graph elements
and the axis. We can get rid of that using some <strong>scales</strong>
<strong>functions</strong>.</p>
<pre class="r"><code># specify data and variables
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) +
  
  # add data bars
  geom_col(color = &#39;black&#39;,
           position = position_dodge()) + # this puts the groups side-by-side instead of stacked
  
  # add error bars
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd),
                position = position_dodge(0.9),
                width = 0.2) +

# add mean value above bars
  geom_text(aes(label = mean,
                 y = mean + (sd + 1)),
            position = position_dodge(width = 0.9)) +
  
   # add labels
  labs(title = &quot;Tooth growth&quot;, 
       x= &quot;Dose (mg)&quot;, 
       y = &quot;Length (mm)&quot; ,
       fill = &#39;Delivery method&#39;) +
  
   # add theme
   theme_classic() +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14),
        plot.title = element_text(hjust = 0.5,
                                  size = 16),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 14)) +
  
  # manually alter colors
   scale_fill_manual(values = c(&#39;#E69F00&#39;, &#39;#999999&#39;),
                     labels = c(&#39;Orange juice&#39;, &#39;Ascorbic acid&#39;)) +
  
  # remove extra space between graph and x axis
  scale_x_discrete(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0),
                     limits = c(0, 35))</code></pre>
<p><img src="mod_2_ggplot_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>Ta-da!</p>
<p>Hopefully now you can see how useful <strong>ggplot</strong> can be.
And also how helpful it is to following the <em>best coding
practices</em> keeping your code well spaced, indented, and annotated.
If not check out the code below, this is code for the same plot but not
following best coding practices and I’ve made a mistake, can you find
it?</p>
<pre class="r"><code># example of messy code
ggplot(sumTC, aes(x = dose, y = mean, fill = supp)) + geom_col(color = &#39;black&#39;, position = position_dodge()) +
  geom_errorbar(aes(ymin=mean -sd, ymax = mean + sd),position = position_dodge(0.9),width = 0.2) +
  geom_text(aes(label=mean,y =mean +(sd +1)),position = position_dodge(width = 0.9)) + abs(title = &quot;Tooth growth&quot;, 
       x= &quot;Dose (mg)&quot;, y = &quot;Length (mm)&quot; ,fill = &#39;Delivery method&#39;) +
   theme_classic() +
  theme(axis.text = element_text(size = 12),axis.title = element_text(size = 14), plot.title = element_text(hjust = 0.5,size = 16),
        legend.text = element_text(size = 12),legend.title = element_text(size = 14)) +
   scale_fill_manual(values = c(&#39;#E69F00&#39;, &#39;#999999&#39;),labels = c(&#39;Orange juice&#39;, &#39;Ascorbic acid&#39;)) +
  scale_x_discrete(expand = c(0, 0)) +cale_y_continuous(expand = c(0, 0),
                     limits = c(0, 35))</code></pre>
</div>
<div id="assignment-and-next-module" class="section level2">
<h2>Assignment and next module</h2>
<p><a href="assign_6.html">–assignment 6–</a></p>
<p><a href="mod_3_adv_ggplot.html">–go to next module–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
